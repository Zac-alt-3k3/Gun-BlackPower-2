
local SetLag = 3 -- You can set this number to reduce lag minimum = 0 & maximumu = 10 

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ")
print("â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘ â•šâ•â•â–ˆâ–ˆâ•”â•â•â• â–ˆâ–ˆâ•”â•â•â•â•")
print("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â•šâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ")

local player = game:GetService("Players").LocalPlayer
local RunService = game:GetService("RunService")

-- Kiá»ƒm tra script Ä‘Ã£ cháº¡y chÆ°a
if _G.CombatSystemRunning then
    warn("Há»‡ thá»‘ng Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t trÆ°á»›c Ä‘Ã³")
print("â–ˆâ–ˆâ•”â•â•â•    â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘      â•šâ•â•â•â•â–ˆâ–ˆ")
print("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ")
print("â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•      â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•   â•šâ•â•    â•šâ•â•      â•šâ•â•â•â•â•â•")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("Advanced Combat System with Anti-Cheat Protection")
print("Developing by Zac")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    return
end
_G.CombatSystemRunning = true

-- Cáº¥u hÃ¬nh há»‡ thá»‘ng
local ATTACK_COOLDOWN = 1
local lastAttackTime = 0
local currentMode = 2 -- 1: Dá»«ng, 2: BÃ¬nh thÆ°á»ng, 3: Clear Zombie
local highlightEnabled = true -- LuÃ´n báº­t highlight
local WaitTime = 0
 
-- Cache cÃ¡c hÃ m thÆ°á»ng dÃ¹ng
local GetDescendants = workspace.GetDescendants
local osClock = os.clock
local mathRandom = math.random
local Vector3New = Vector3.new
local ipairs = ipairs
local unpack = unpack

-- Danh sÃ¡ch cÃ¡c loáº¡i zombie
local ZOMBIE_TYPES = {"Agent", "Slim"}

-- Táº¡o UI Ä‘Æ¡n giáº£n vá»›i nÃºt chuyá»ƒn cháº¿ Ä‘á»™
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CombatSystemUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player.PlayerGui

local mainFrame1 = Instance.new("Frame")
mainFrame1.Size = UDim2.new(0, 250, 0, 80)
mainFrame1.Position = UDim2.new(0.5, -125, 0, 10)
mainFrame1.BackgroundTransparency = 0.8
mainFrame1.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
mainFrame1.Parent = screenGui

local autoAttackLabel = Instance.new("TextLabel")
autoAttackLabel.Size = UDim2.new(1, 0, 0.5, 0)
autoAttackLabel.Position = UDim2.new(0, 0, 0, 0)
autoAttackLabel.Text = "âš”ï¸ Tá»° Äá»˜NG Táº¤N CÃ”NG: ÄANG Báº¬T"
autoAttackLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
autoAttackLabel.BackgroundTransparency = 1
autoAttackLabel.Font = Enum.Font.SourceSansBold
autoAttackLabel.TextSize = 14
autoAttackLabel.Parent = mainFrame1

local highlightLabel = Instance.new("TextLabel")
highlightLabel.Size = UDim2.new(1, 0, 0.5, 0)
highlightLabel.Position = UDim2.new(0, 0, 0.5, 0)
highlightLabel.Text = "ğŸ” HIGHLIGHT ZOMBIE: ÄANG Báº¬T"
highlightLabel.TextColor3 = Color3.fromRGB(0, 200, 255)
highlightLabel.BackgroundTransparency = 1
highlightLabel.Font = Enum.Font.SourceSansBold
highlightLabel.TextSize = 14
highlightLabel.Parent = mainFrame1

local mainFrame2 = Instance.new("Frame")
mainFrame2.Size = UDim2.new(0, 250, 0, 60)
mainFrame2.Position = UDim2.new(0.5, -125, 0, 100)  -- 30 cuá»‘i
mainFrame2.BackgroundTransparency = 0.8
mainFrame2.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
mainFrame2.Parent = screenGui

local modeButton = Instance.new("TextButton")
modeButton.Size = UDim2.new(0.9, 0, 0.8, 0)
modeButton.Position = UDim2.new(0.05, 0, 0.1, 0)
modeButton.Text = "Cháº¿ Ä‘á»™: BÃ¬nh thÆ°á»ng"
modeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
modeButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
modeButton.Parent = mainFrame2

--Fix lag cho chay cháº­m hÆ¡n
WaitTime = SetLag*0.4
if SetLag > 10 then 
WaitTime = 1.5
elseif SetLag <= 1 then 
WaitTime = 0
end


-- HÃ m cáº­p nháº­t giao diá»‡n
local function updateModeDisplay()
    if currentMode == 1 then
        modeButton.Text = "Cháº¿ Ä‘á»™: Dá»«ng"
        modeButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
    elseif currentMode == 2 then
        modeButton.Text = "Cháº¿ Ä‘á»™: BÃ¬nh thÆ°á»ng"
        modeButton.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
    elseif currentMode == 3 then
        modeButton.Text = "Cháº¿ Ä‘á»™: Clear Zombie"
        modeButton.BackgroundColor3 = Color3.fromRGB(170, 170, 0)
    end
end

-- NÃºt chuyá»ƒn cháº¿ Ä‘á»™
modeButton.MouseButton1Click:Connect(function()
    currentMode = currentMode + 1
    if currentMode > 3 then
        currentMode = 1
    end
    updateModeDisplay()
    
    -- ThÃ´ng bÃ¡o khi Ä‘á»•i cháº¿ Ä‘á»™
    game.StarterGui:SetCore("SendNotification", {
        Title = "ÄÃƒ Äá»”I CHáº¾ Äá»˜",
        Text = modeButton.Text,
        Duration = 3
    })
end)

wait(0.1)
game.StarterGui:SetCore("SendNotification", {
    Title = "Há»† THá»NG KHá»I Äá»˜NG",
    Text = "âš”ï¸ â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ”",
    Duration = 5
})

wait(0.1)

game.StarterGui:SetCore("SendNotification", {
    Title = "ğŸ”„ï¸ÄANG Xá»¬ LÃ AUTOKILL....",
    Text = "âš”ï¸ Tá»± Ä‘á»™ng táº¥n cÃ´ng Zombies !",
    Duration = 5
})

-- Há»‡ thá»‘ng táº¥n cÃ´ng
local function executeAttack()
    if currentMode == 1 then return end -- Cháº¿ Ä‘á»™ dá»«ng
    
    local currentTime = osClock()
    if currentTime - lastAttackTime < ATTACK_COOLDOWN then return end
    
    local character = player.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    local weapon = character:FindFirstChildWhichIsA("Tool")
    if not weapon then return end
    
    local remoteEvent = weapon:FindFirstChildWhichIsA("RemoteEvent") or
                       weapon:FindFirstChild("MeleeBase") and weapon.MeleeBase:FindFirstChildWhichIsA("RemoteEvent")
    if not remoteEvent then return end

    -- TÃ¬m zombie trong workspace
    local zombiesInRange = {}
    local rootPos = humanoidRootPart.Position
    
    for _, agent in ipairs(workspace:GetDescendants()) do
        for _, zombieType in ipairs(ZOMBIE_TYPES) do
            if agent.Name == zombieType then
                local head = agent:FindFirstChild("Head")
                if head then
                    local humanoid = agent:FindFirstChildOfClass("Humanoid")
                    if humanoid and humanoid.Health > 0 then
                        local dist = (head.Position - rootPos).Magnitude
                        if dist <= 19 then
                            table.insert(zombiesInRange, {
                                model = agent,
                                head = head
                            })
                            break
                        end
                    end
                end
                break
            end
        end
    end

    if #zombiesInRange > 0 then
        for _, zombie in ipairs(zombiesInRange) do
            local hitPos = zombie.head.Position
            local dir = (hitPos - rootPos).Unit
            local knockback = dir * 15
            
            -- Gá»­i sá»± kiá»‡n Swing + Hit (1 láº§n)
            remoteEvent:FireServer("Swing", "Thrust")
            remoteEvent:FireServer(
                "HitZombie",
                zombie.model,
                hitPos,
                true,
                knockback,
                "Head",
                Vector3New(mathRandom(), mathRandom(), mathRandom()).Unit
            )
            
            -- Cháº¿ Ä‘á»™ Clear Zombie: gá»­i thÃªm 2 láº§n Swing + Hit (tá»•ng 3 láº§n)
            if currentMode == 3 then
                for i = 1, 4 do
                    task.wait(0.05)
                    remoteEvent:FireServer("Swing", "Thrust")
                    remoteEvent:FireServer(
                        "HitZombie",
                        zombie.model,
                        hitPos + Vector3New(0, 0.2 * i, 0),
                        true,
                        knockback * (1 + i * 0.1),
                        "Head",
                        Vector3New(mathRandom(), mathRandom(), mathRandom()).Unit * (1 + i * 0.2)
                    )
                end
            end
        end
        
        lastAttackTime = currentTime
    end
end

game.StarterGui:SetCore("SendNotification", {
    Title = "âœ… Xá»¬ LÃ AUTOKILL SUCCESSFULL",
    Text = "âš”ï¸ Tá»± Ä‘á»™ng táº¥n cÃ´ng Zombies !",
    Duration = 5
})

wait(0.1)

game.StarterGui:SetCore("SendNotification", {
    Title = "ğŸ”„ï¸ÄANG Xá»¬ LÃ HIGHLIGHT....",
    Text = "ğŸ” Tá»± Ä‘á»™ng highlight zombie",
    Duration = 5
})


local highlightConfig = {
    Torch = {Color = Color3.fromRGB(100, 255, 100), Transparency = 0.2},
    Axe = {Color = Color3.fromRGB(255, 100, 100), Transparency = 0.2},
    Default = {Color = Color3.fromRGB(240, 240, 240), Transparency = 0.2}
}

local player = game.Players.LocalPlayer
local zombieModelName = "m_Zombie"
local cameraFolder = workspace:WaitForChild("Camera")

local function applyGuaranteedHighlight(model)
    -- Fix 1: Äáº£m báº£o PrimaryPart tá»“n táº¡i
    if not model.PrimaryPart then
        model.PrimaryPart = model:FindFirstChildWhichIsA("BasePart") or model:WaitForChild("HumanoidRootPart", 2)
        if not model.PrimaryPart then return end
    end

    -- Fix 5: Chá»‰ highlight khi trong táº§m nhÃ¬n
    local camera = workspace.CurrentCamera
    local screenPoint = camera:WorldToViewportPoint(model.PrimaryPart.Position)
    if screenPoint.Z <= 0 then return end

    -- XÃ³a highlight cÅ©
    for _,v in ipairs(model:GetDescendants()) do
        if v.Name:sub(1,4) == "ZHL_" then
            v:Destroy()
        end
    end

    -- Táº¡o highlight má»›i
    local highlight = Instance.new("Highlight")
    highlight.Name = "ZHL_"..math.random(1,9999) -- Fix 4
    highlight.Adornee = model
    highlight.FillTransparency = highlightConfig.Default.Transparency
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop

    -- Chá»n mÃ u
    if model:FindFirstChild("Torch", true) then
        highlight.FillColor = highlightConfig.Torch.Color
    elseif model:FindFirstChild("Axe", true) then
        highlight.FillColor = highlightConfig.Axe.Color
    else
        highlight.FillColor = highlightConfig.Default.Color
    end

    highlight.Parent = model
end

-- Fix 3: Giá»›i háº¡n khoáº£ng cÃ¡ch
local function updateHighlights()
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end

    for _, model in ipairs(cameraFolder:GetDescendants()) do
        if model:IsA("Model") and model.Name == zombieModelName and model.PrimaryPart then
            local distance = (char.HumanoidRootPart.Position - model.PrimaryPart.Position).Magnitude
            if distance < 80 then -- 100 studs
                applyGuaranteedHighlight(model)
            end
        end
    end
end

wait(2)
game.StarterGui:SetCore("SendNotification", {
    Title = "âœ… Xá»¬ LÃ HIGHLIGHT SUCCESSFUL",
    Text = "ğŸ” Tá»± Ä‘á»™ng highlight zombie",
    Duration = 5
})
wait(0.1)

game.StarterGui:SetCore("SendNotification", {
    Title = "ğŸ¨ Há»‡ thá»‘ng highlight",
    Text = "ğŸ”§ Quy táº¯c mÃ u má»›i:",
    Duration = 5
})
wait(0.1)
game.StarterGui:SetCore("SendNotification", {
    Title = "----------------------",
    Text = "ğŸŸ¢ Chá»‰ Torch â¡ï¸ Xanh lÃ¡;ğŸ”´Chá»‰ Axe    â¡ï¸ Äá»",  
   Duration = 5
})

-- Káº¿t ná»‘i vá»›i Heartbeat
RunService.Heartbeat:Connect(function()
    
    wait(WaitTime) 
    pcall(executeAttack)
    wait(WaitTime)
    pcall(updateHighlights)
end)

-- Khá»Ÿi táº¡o hiá»ƒn thá»‹
updateModeDisplay()

-- ThÃ´ng bÃ¡o khá»Ÿi Ä‘á»™ng
game.StarterGui:SetCore("SendNotification", {
    Title = "Há»† THá»NG ÄÃƒ Sáº´N SÃ€NG",
    Text = "âš”ï¸ â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ” ",
    Duration = 5
})

print("â–ˆâ–ˆâ•”â•â•â•    â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘      â•šâ•â•â•â•â–ˆâ–ˆ")
print("â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ")
print("â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•      â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•   â•šâ•â•    â•šâ•â•      â•šâ•â•â•â•â•â•")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("Advanced Combat System without Anti-Cheat Protection")
print("Developing by Zac")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
